var tObserverNoStricts=function(){var q=function(){var n={option:"htmloption",OPTION:"htmloption",Option:"htmloption",htmlOption:"htmloption",htmlOPTION:"htmloption",htmloption:"htmloption",list:"htmllist",List:"htmllist",LIST:"htmllist",htmlList:"htmllist",htmllist:"htmllist",htmlLIST:"htmllist",html:"innerhtml",Html:"innerhtml",HTML:"innerhtml",innerHTML:"innerhtml",innerhtml:"innerhtml",innerHtml:"innerhtml",value:"value",Value:"value",VALUE:"value",disabled:"disables",DISABLED:"disables",Disabled:"disables"},
e=document.createElement("div").style,k;for(k in e)n[k]=k,n[k.toUpperCase()]=k,n[k.toLowerCase()]=k;return n}();return{getAttr:function(n){if(n.attr)return n.attr;var e=void 0===n.getAttribute?null:n.getAttribute("tObserver");if(null===e)return null;with(q)try{e=eval("({"+e+"})")}catch(k){try{e=eval("("+e+")")}catch(u){e={path:e}}}e.path||(e.path=[""]);Array.isArray(e.path)||(e.path=[e.path]);for(var p in e.path)e.path[p]="."==e.path[p][e.path[p].length-1]?e.path[p].slice(0,e.path[p].length-1):e.path[p],
e.path[p]=""===e.path[p]?"":e.path[p];e.type=e.type?e.type:"innerhtml";Array.isArray(e.type)||(e.type=[e.type]);Array.isArray(e.filter)||(e.filter=[e.filter]);return n.attr=e}}}(),tobserver=function(q,n,e){function k(a,c,b){c||(c=new this.ObserverTree);b||(b="");this.data=a;this.observer=c;this.path=b}function u(a,c){return c?""===a?c:a+"."+c:a}function p(a,c){var b=g.getData(a),f;for(f in b)if(c[f]!==e&&b)c[f](a,b)}function r(a){for(var c="",b=0;b<a.length;b++)c+=(""===c?"":".")+a[b];return c}var w=
function(a){return a},t=function(){},x=function(a,c){c(a)},y=function(){var a={'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;"};return function(c){return"string"!==typeof c?c:c.replace(/[\"&'\/<>]/g,function(b){return a[b]})}}(),v=function(a){for(;-1!==a.indexOf("");)a.splice(a.indexOf(""),1);return a},g;k.prototype.get=function(a){a=(a+"").split(".");if(0===a.length)return this;var c=a[0];if(""===c)return this;if(1===a.length)return new k(this.data===e?e:this.data[c],this.observer,
u(this.path,c));a.splice(0,1);return(new k(this.data[c],this.observer,u(this.path,c))).get(r(a))};k.prototype.getData=function(a){a=(a+"").split(".");a=v(a);var c=this.data,b;for(b in a)if(c[a[b]]!==e&&null!==c[a[b]])c=c[a[b]];else return e;return c};k.prototype.innerSet=function(a,c,b){var f=(a+"").split(".");if(0===f.length)return null;if(1===f.length){if(b)return this.data[a].apply(this.data,c);this.data[a]!==c&&(this.data[a]=c);return this}a=f.pop();return this.get(r(f)).innerSet(a,c,b)};k.prototype.set=
function(a,c,b,f,d){b||(b=!1);f===e&&(f=!0);var l=g.getData(a);if(b||l!==c)return this.notify(a,c,b,f,d),this.innerSet(a,c,b)};k.prototype.exec=k.prototype.run=function(a,c){this.set(a,c,!0)};k.prototype.on=function(a,c){c&&(c="function"==typeof c?{update:c}:c,this.observer.addListener(c,a))};k.prototype.off=function(a,c){this.observer.removeListener(a,c)};k.prototype.notify=function(a,c,b,f,d,l){a===e&&(a="");l===e&&(l=(new Date).getTime()+""+Math.random());a=u(this.path,a);var s=this.notifyee.commands.indexOfIn(a,
"path");if(b||c!==g.getData(a)&&(-1===s||!this.notifyee.commands[s].run))this.notifyee.commands.push({path:a,data:c,run:b,online:g.notifyee.onlineMode?f:!1,socket:d}),clearTimeout(g.notifyee.timeout),g.notifyee.timeout=setTimeout(function(){g.notifyee.notify(l)},g.notifyee.speed)};Array.prototype.indexOfIn=function(a,c){for(var b in this)if(this[b][c]===a)return b;return-1};Object.defineProperty(Array.prototype,"indexOfIn",{enumerable:!1});k.prototype.notifyee={notify:function(a){var c=this.commands;
this.commands=[];this.onlineMode=this.onlineLiveMode;for(var b in c)g.observer.runUpdate(c[b].path,a),this.socket&&c[b].online&&!this.isLocal(c[b].path)&&(c[b].socket?c[b].socket.broadcast.emit("tOmand",JSON.stringify({path:c[b].path,data:c[b].data,run:c[b].run})):this.socket.emit("tOmand",JSON.stringify({path:c[b].path,data:c[b].data,run:c[b].run})));this.onlineMode=!0},onlineMode:!0,onlineLiveMode:!1,commands:[],locals:[],isLocal:function(a){var c=this.locals,b;for(b in c)if(0===a.indexOf(c[b]))return!0;
return!1},socket:e,timeout:0,speed:1};k.prototype.ObserverTree=function(){function a(a,b){this.$listener=[];b||(b="");a!==e&&(""===b?this.$listener.push(a):this.addListener(a,b))}a.prototype.addListener=function(c,b){var f=b.split("."),f=v(f);if(0<f.length){var d="_t_"+f[0];f.shift();this[d]===e?this[d]=new a(c,r(f)):this[d].addListener(c,r(f))}else this.$listener.push(c)};a.prototype.runUpdate=function(a,b){b||(b=(new Date).getTime()+""+Math.random());a||(a="");var f=v(a.split(".")),d;for(d in this.$listener)this.$listener[d].tNotificationRoundNumber!=
b&&(this.$listener[d].tNotificationRoundNumber=b,this.$listener[d].update(b,f));if(0<f.length)d="_t_"+f[0],this[d]!==e&&(f.splice(0,1),this[d].runUpdate(r(f),b));else for(var l in this)0===l.indexOf("_t_")&&this[l].runUpdate("",b)};a.prototype.removeListener=function(a,b){a||(a="");var f=a.split("."),f=v(f),d="_t_"+f[0];if(1<f.length||b&&0<f.length)f.shift(),this[d]!==e&&this[d].removeListener(r(f),b);else if(1===f.length&&this[f[0]]!==e)for(var l in this.$listener)"string"===typeof this.$listener[l].name&&
this.$listener[l].name===d&&this.$listener.splice(l,1);else if(b)for(f=0;f<this.$listener.length;f++)this.$listener[f]!==b&&this.$listener[f].update!==b||this.$listener.splice(f,1)};return a}();k.prototype.StdElementView=function(){function a(b,a){var d=c(b);if(null!==d&&b._tName===e){d.outer=d.outer!==e?d.outer:"div";d.path=""===d.path?"window":d.path;this.element=b;d.defaultValue=[];d.preview=[];for(var l in d.type)"htmllist"===d.type[l].toLowerCase()||"htmloption"===d.type[l].toLowerCase()||"innerhtml"===
d.type[l].toLowerCase()?(d.defaultValue[l]=b.innerHTML,d.preview[l]=this.element.innerHTML,this.element.innerHTML=""):d.defaultValue[l]=b.getAttribute(d.type),"value"===d.type[l]&&this.folowElement(b);d.beforeAdd=d.beforeAdd!==e?d.beforeAdd:a.utils.stdViewBehavior.beforeAdd;d.afterAdd=d.afterAdd!==e?d.afterAdd:a.utils.stdViewBehavior.afterAdd;d.beforeRemove=d.beforeRemove!==e?d.beforeRemove:a.utils.stdViewBehavior.beforeRemove;d.afterRemove=d.afterRemove!==e?d.afterRemove:a.utils.stdViewBehavior.afterRemove;
d.beforeUpdate=d.beforeUpdate!==e?d.beforeUpdate:a.utils.stdViewBehavior.beforeUpdate;d.afterUpdate=d.afterUpdate!==e?d.afterUpdate:a.utils.stdViewBehavior.afterUpdate;var g="tObserverName"+1E16*Math.random();this.name=g;this.element._tName=g;this.element._tObserver=this;this.attr=this.element.attr=d;for(l in d.path)a.on(d.path[l],this);this.update()}}var c=tObserverNoStricts.getAttr;a.prototype.update=function(){var b,a=w,d=this.attr.path.length;d<this.attr.type.length&&(d=this.attr.type.length);
for(var c=0;c<d;c++){var s=this.attr.path[c]===e?s:this.attr.path[c];b=this.attr.type[c]?this.attr.type[c]:b;var a="value"===b||"data"===b?w:y,h=g.getData(s),m=h="number"===typeof h?h+"":h,a=this.attr.filter[c]?this.attr.filter[c]:a,h=a(h),h=h!==e?h:this.attr.defaultValue[c];b=this.attr.type[c]?this.attr.type[c]:b;switch(b){case "innerhtml":case "innerHtml":case "innerHTML":case e:h||(h=this.attr.defaultValue[c]);this.attr.beforeUpdate(this.element,function(b){b.innerHTML!=h&&(b.innerHTML=h,b.attr.afterUpdate(b));
b.attr.afterUpdate(b)});break;case "data":this.element.data=h;break;case "htmllist":case "htmlList":this.updateList(h,m);break;case "htmloption":case "htmlOption":this.updateOption(h,m);break;case "value":this.attr.beforeUpdate(this.element,function(b){b.value!=h&&(b.value=h,b.attr.afterUpdate(b))});break;default:this.attr.beforeUpdate(this.element,function(a){if("disabled"==b)a.disabled=h;else if(a.style[b]!==e||"src"==b||"class"==b){if(a.getAttribute(b)==h)return;a.setAttribute(b,h)}else{if(a.style[b]==
h)return;a.style[b]=h}a.attr.afterUpdate(a)})}}};a.prototype.updateOption=function(b,a){if(!1==b||b==e||null==b)this.element.innerHTML="",this.element.display="none";else if(this.element.display="",""===this.element.innerHTML){var d=n.createElement("div");d.innerHTML=this.attr.preview;for(this.findAndUpdatePath(d,this.attr.path);d.children[0]!==e;)this.attr.beforeAdd(d.children[0],a),this.element.appendChild(d.children[0]),this.attr.afterAdd(d.children[0],a)}};a.prototype.updateList=function(b,a){this.displayedOrdData!=
a&&(this.element.innerHTML="");var d=0;this.displayedOrdData=a;for(var c=this.element.children,s=[],h=[],d=0;d<c.length;d++){var m=b.indexOf(c[d].item);-1==m?(c[d].innerHTML=c[d].innerHTML.replace("tobserver","removedtObserver").trim(),this.attr.beforeRemove(c[d],function(b){b&&(b.remove(),d--)})):(this.attr.beforeUpdate(c[d],t),s.push(c[d].item),"tobserverlistitem"==c[d].className&&(m!=c[d].position&&this.updateRootPath(c[d],this.attr.path+"."+m,this.attr.path+"."+c[d].position),c[d].position=m,
h.push(c[d])))}c=n.activeElement;h.sort(function(b,a){return b.position-a.position});for(d=0;d<h.length;d++)this.element.appendChild(h[d]);c.focus();c=0;if(a){for(d=0;d<b.length;d++)if(h[c]!==e&&b[d]==h[c].item)c++;else if(-1==s.indexOf(b[d])){var m=a.indexOf(b[d]),k=n.createElement(this.attr.outer);k.setAttribute("class","tobserverlistitem");k.innerHTML=this.attr.preview;this.findAndUpdatePath(k,this.attr.path+"."+m);k.position=d;k.item=b[d];h[c]!==e?h[c].parentNode.insertBefore(k,h[c]):this.element.appendChild(k);
g.StdElementView.findTObserver(k);this.attr.beforeAdd(k,b[d]);this.attr.afterAdd(k,b[d])}c=this.element.children}};a.prototype.findAndUpdatePath=function(b,a){var d=c(b),e=b.children;if(null===d)for(var g in e)this.findAndUpdatePath(e[g],a);else this.setRoot(b,a)};a.prototype.setRoot=function(b,a){var d=c(b);d.path||(d.path=[""]);for(var e in d.path)-1==d.path[e].indexOf(a)&&(d.path[e]=a+"."+d.path[e])};a.prototype.updateRootPath=function(b,a,c){if(b&&a&&c){b=b.children;for(var e in b)if(b[e].attr)for(var k in b[e].attr.path){var h=
b[e].attr.path[k].replace(c+".","");"htmllist"==b[e].attr.type[k].toLowerCase()&&this.updateRootPath(b[e],h+"."+h,c+"."+h);g.off(b[e].attr.path[k]+"."+b[e]._tName);g.on(a+"."+h,b[e]._tObserver);b[e].attr.path[k]=a+"."+h}else this.updateRootPath(b[e],a,c)}};a.prototype.folowElement=function(a){var c=function(){var c=a.attr,e;for(e in c.path)if("value"===c.type[e]){var f=a.value,h=a.getAttribute("type");null!==h&&"number"===h.toLocaleLowerCase().trim()&&(f=parseFloat(f));null!==h&&"checkbox"===h.toLocaleLowerCase().trim()&&
(f=a.checked);g.set(c.path[e],f)}};a.addEventListener("change",c);a.addEventListener("keyup",c)};a.initDomViews=function(){var b=n.getElementsByTagName("html")[0];g.utils.bindEvent(b,"DOMNodeInserted",function(b){a.findTObserver(b.srcElement?b.srcElement:b.target)});g.utils.bindEvent(b,"DOMNodeRemoved",function(a){var b=a.srcElement?a.srcElement:a.target;b!==e&&b.getAttribute!==e&&setTimeout(function(){var a=c(b);a!==e&&b._tName!==e&&(a=a.path,a=a!==e?a:"",g.off(a+"."+b._tName))},1E3)});this.findTObserver()};
a.findTObserver=function(b){b===e&&(b=n.getElementsByTagName("html")[0]);var f=c(b),d=b.children;if(null===f)for(var l in d)a.findTObserver(d[l]);else b.attr=f,new g.StdElementView(b,g)};return a}();k.prototype.utils={stdViewBehavior:{beforeAdd:t,afterAdd:t,beforeRemove:x,afterRemove:t,beforeUpdate:x,afterUpdate:t},linkViews:function(a,c){g.on(a,new this.LinkView(c));g.on(c,new this.LinkView(a))},linkToArrayViews:function(a,c){g.on(a,new this.LinkToArrayView(a,c));g.on(c,new this.LinkFromArrayView(a,
c))},LinkView:function(a){this.update=function(c){var b=g.getData(a);g.notify(a,b,!1,!0,e,c)}},LinkToArrayView:function(a,c){this.update=function(b){var f=g.getData(a),d=g.getData(c),f=c+"."+d.indexOf(f);g.notify(f,"someCrapthatWIllneverBeAValue5142f7d9aj8496547c6fc6gca37f215cf",!1,!0,e,b)}},LinkFromArrayView:function(a,c){this.update=function(b,f){var d=g.getData(a),l=g.getData(c),k=l.indexOf(d);f[0]!==e&&k==f[0]&&l[f[0]]!==d&&g.notify(a,"someCrapthatWIllneverBeAValue5142f7d9ja8496547g6fc65ca37f215cf",
!1,!0,e,b)}},ArrayUpdateView:function(a,c){this.update=function(b,f){if(f[0]!==e&&f[1]!==e){var d=f.splice(0,1),l=f.splice(0,1),k=g.getData(a+"."+d);if(k&&c[l])c[l](a+"."+d,k,f)}else for(d=g.getData(a),l=0;l<d.length;l++)p(a+"."+l,c)}},registerArrayUpdateView:function(a,c){g.on(a,new g.utils.ArrayUpdateView(a,c));for(var b=g.getData(a),e=0;e<b.length;e++)p(a+"."+e,c)},ObjectUpdateView:function(a,c){this.update=function(b,f){if(f[0]!==e){var d=f.splice(0,1),l=g.getData(a);if(l)c[d](a,l,f)}else p(a,
c)}},registerObjectUpdateView:function(a,c){g.on(a,new g.utils.ObjectUpdateView(a,c));p(a,c)},history:function(){var a={},c=function(){},b={},f=Array.prototype.slice,d=Array.prototype.some,l=Array.prototype.forEach,k=Function.prototype.bind;a.bind=function(b,d){var e;if(k&&b.bind===k)return k.apply(b,f.call(arguments,1));if(!a.isFunction(b))throw new TypeError;e=f.call(arguments,2);return function(){if(!(this instanceof void 0))return b.apply(d,e.concat(f.call(arguments)));c.prototype=b.prototype;
var a=new c;c.prototype=null;var h=b.apply(a,e.concat(f.call(arguments)));return Object(h)===h?h:a}};a.bindAll=function(b){var c=f.call(arguments,1);if(0===c.length)throw Error("bindAll must be passed function names");h(c,function(c){b[c]=a.bind(b[c],b)});return b};var h=a.each=a.forEach=function(c,d,e){if(null==c)return c;var f,h;if(l&&c.forEach===l)c.forEach(d,e);else if(c.length===+c.length)for(f=0,h=c.length;f<h;f++){if(d.call(e,c[f],f,c)===b)return}else{var g=a.keys(c);f=0;for(h=g.length;f<h;f++)if(d.call(e,
c[g[f]],g[f],c)===b)return}return c};a.identity=function(a){return a};a.some=a.any=function(a,c,e){var f=!1;if(null==a)return f;if(d&&a.some===d)return a.some(c,e);h(a,function(a,d,h){if(f||(f=c.call(e,a,d,h)))return b});return!!f};var m=function(){a.bindAll(this,"checkUrl");q!==e&&(this.location=q.location,this.history=q.history)},p=/^[#\/]|\s+$/g,r=/^\/+|\/+$/g,z=/msie [\w.]+/,t=/\/$/,u=/#.*$/;m.started=!1;m.prototype.interval=50;m.prototype.atRoot=function(){return this.location.pathname.replace(/[^\/]$/,
"$&/")===this.root};m.prototype.getHash=function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""};m.prototype.getFragment=function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(t,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(p,"")};m.prototype.start=function(a){if(m.started)throw Error("history has already been started");m.started=!0;this.options=a===e?
{}:a;this.options.root="/";this.path=this.options.path===e?"url":this.options.path;this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);a=this.getFragment();var b=n.documentMode,b=z.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b);this.root=("/"+this.root+"/").replace(r,"/");b&&this._wantsHashChange&&(this.iframe=$('<iframe src="javascript:0" tabindex="-1">').hide().appendTo("body")[0].contentWindow,
this.navigate(a));if(this._hasPushState)$(q).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in q&&!b)$(q).on("hashchange",this.checkUrl);else this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&
a.hash&&(this.fragment=this.getHash().replace(p,""),this.history.replaceState({},n.title,this.root+this.fragment))}$(n).on("click","a[href^='/']",function(a){var b=$(a.currentTarget).attr("href");if(!(0<=b.indexOf("sign_out")||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey))return a.preventDefault(),a=b.replace(/^\//,"").replace("#!/",""),g.utils.history.navigate(a,{trigger:!0}),!1});g.on(this.path,function(){var a=g.getData(g.utils.history.path);g.utils.router.route(a)});if(!this.options.silent)return this.loadUrl()};
m.prototype.stop=function(){$(q).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);this._checkUrlInterval&&clearInterval(this._checkUrlInterval);m.started=!1};m.prototype.route=function(a,b){this.handlers.unshift({route:a,callback:b})};m.prototype.checkUrl=function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.navigate(a);this.iframe&&this.navigate(a);this.loadUrl()};m.prototype.loadUrl=function(a){a=
this.fragment=this.getFragment(a);g.set(this.path,a)};m.prototype.navigate=function(a,b){if(!m.started)return!1;b&&!0!==b||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));a=a.replace(u,"");if(this.fragment!==a){this.fragment=a;""===a&&"/"!==c&&(c=c.slice(0,-1));if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},n.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);if(b.trigger)return this.loadUrl(a)}};m.prototype._updateHash=function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b};return new m}(),router:function(a){function c(){this.events=[];this.params=[]}c.prototype.version="0.4.2";c.prototype.route=function(a){var c=Array.prototype.slice.call(arguments,1);this.events.forEach(function(a){a.apply(this,
c)});return this};c.regexRoute=function(a,c,d,e){if(a instanceof RegExp)return a;a instanceof Array&&(a="("+a.join("|")+")");a=a.concat(e?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,b,d,e,g,k){c.push({name:e,optional:!!k});b=b||"";return""+(k?"":b)+"(?:"+(k?b:"")+(d||"")+(g||d&&"([^/.]+?)"||"([^/]+?)")+")"+(k||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)");return new RegExp("^"+a+"$",d?"":
"i")};c.prototype.on=c.prototype.add=c.prototype.get=function(a,f){var d=this,g=[],k=c.regexRoute(a,g);this.events.push(function(c){var m=q.url.match(k);if(m){c={route:a,value:c,handler:f,params:d.params,regex:m,propagateEvent:!0,preventDefault:function(){this.propagateEvent=!1}};var n={params:{},keys:g,matches:c.regex.slice(1)};n.matches.forEach(function(a,b){n.params[g[b]&&g[b].name?g[b].name:b]=a?decodeURIComponent(a):e});f.call(d,n,c)}return d});return this};return new c}.call({},q),bindEvent:function(a,
c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent&&a.attachEvent("on"+c,b)},setSocket:function(a){g.notifyee.socket=a;a.on("tOmand",function(a){try{var b=JSON.parse(a);g.notifyee.isLocal(b.path)||g.set(b.path,b.data,b.run,!1)}catch(e){}})},jQuerySocket:function(a){this.emit=function(c,b){$.post(a,{name:c,data:b})}}};return g=new k(q)}("object"===typeof window?window:{},"object"===typeof document?document:{});
"object"===typeof module?module.exports=tobserver:window instanceof  Window&&tobserver.utils.bindEvent(window,"load",function(){var q=document.createElement("style");q.innerHTML=".tobserverlistitem{margin:0px;\tpadding:0px;}";document.getElementsByTagName("head")[0].appendChild(q);tobserver.StdElementView.initDomViews()});